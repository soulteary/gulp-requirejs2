function optimize(e,i){e.out=i,e.optimize=e.optimize||"none",requirejs.optimize(e)}var gulpUtil=require("gulp-util"),requirejs=require("requirejs"),PluginError=gulpUtil.PluginError,File=gulpUtil.File,fs=require("fs"),es=require("event-stream"),pkg=JSON.parse(fs.readFileSync("./package.json","utf8")),pluginName=pkg.name;module.exports=function(e){"use strict";if(!e)throw new PluginError(pluginName,"Missing options array!");if(!e.out&&"string"!=typeof e.out)throw new PluginError(pluginName,"Only single file outputs are supported right now, please pass a valid output file name!");if(!e.baseUrl)throw new PluginError(pluginName,"Pipeing dirs/files is not supported right now, please specify the base path for your script.");var i=es.pause(),r=e.out;return optimize(e,function(e){i.write(new File({path:r,contents:new Buffer(e)})),i.send()}),i};